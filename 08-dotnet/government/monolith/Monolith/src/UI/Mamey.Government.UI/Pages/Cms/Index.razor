@page "/cms"
@attribute [Authorize(Roles = "Admin,ContentEditor")]

<PageTitle>Content Management - Government Portal</PageTitle>

<MudPaper Elevation="0" Class="pa-6">
    <MudStack Spacing="4">
        <MudStack Row="true" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Center">
            <MudText Typo="Typo.h4" Color="Color.Primary">Content Management System</MudText>
            <MudButton Variant="Variant.Filled" Color="Color.Primary" StartIcon="@Icons.Material.Filled.Add">
                New Content
            </MudButton>
        </MudStack>

        <MudTabs Elevation="0" ApplyEffectsToContainer="true" PanelClass="pa-4">
            <MudTabPanel Text="Pages">
                <MudTable Items="@_pages" Hover="true" Striped="true" Dense="true" Elevation="2">
                    <HeaderContent>
                        <MudTh>Title</MudTh>
                        <MudTh>Slug</MudTh>
                        <MudTh>Status</MudTh>
                        <MudTh>Modified</MudTh>
                        <MudTh>Actions</MudTh>
                    </HeaderContent>
                    <RowTemplate>
                        <MudTd>@context.Title</MudTd>
                        <MudTd><MudText Typo="Typo.body2" Style="font-family: monospace;">@context.Slug</MudText></MudTd>
                        <MudTd>
                            <MudChip T="string" Color="@(context.Published ? Color.Success : Color.Warning)" Size="Size.Small">
                                @(context.Published ? "Published" : "Draft")
                            </MudChip>
                        </MudTd>
                        <MudTd>@context.Modified.ToString("MMM dd, yyyy")</MudTd>
                        <MudTd>
                            <MudButtonGroup Size="Size.Small" Variant="Variant.Text">
                                <MudButton Color="Color.Primary">Edit</MudButton>
                                <MudButton Color="Color.Info">Preview</MudButton>
                            </MudButtonGroup>
                        </MudTd>
                    </RowTemplate>
                </MudTable>
            </MudTabPanel>

            <MudTabPanel Text="News">
                <MudTable Items="@_news" Hover="true" Striped="true" Dense="true" Elevation="2">
                    <HeaderContent>
                        <MudTh>Title</MudTh>
                        <MudTh>Author</MudTh>
                        <MudTh>Status</MudTh>
                        <MudTh>Date</MudTh>
                        <MudTh>Actions</MudTh>
                    </HeaderContent>
                    <RowTemplate>
                        <MudTd>@context.Title</MudTd>
                        <MudTd>@context.Author</MudTd>
                        <MudTd>
                            <MudChip T="string" Color="@(context.Published ? Color.Success : Color.Warning)" Size="Size.Small">
                                @(context.Published ? "Published" : "Draft")
                            </MudChip>
                        </MudTd>
                        <MudTd>@context.Date.ToString("MMM dd, yyyy")</MudTd>
                        <MudTd>
                            <MudButtonGroup Size="Size.Small" Variant="Variant.Text">
                                <MudButton Color="Color.Primary">Edit</MudButton>
                                <MudButton Color="Color.Error">Delete</MudButton>
                            </MudButtonGroup>
                        </MudTd>
                    </RowTemplate>
                </MudTable>
            </MudTabPanel>

            <MudTabPanel Text="Media">
                <MudGrid>
                    @for (int i = 1; i <= 8; i++)
                    {
                        <MudItem xs="6" sm="4" md="3">
                            <MudCard Elevation="2">
                                <MudCardMedia Image="https://via.placeholder.com/200x150" Height="150" />
                                <MudCardContent>
                                    <MudText Typo="Typo.body2">image_@(i).jpg</MudText>
                                </MudCardContent>
                            </MudCard>
                        </MudItem>
                    }
                </MudGrid>
            </MudTabPanel>
        </MudTabs>
    </MudStack>
</MudPaper>

@code {
    private record PageItem(string Title, string Slug, bool Published, DateTime Modified);
    private record NewsItem(string Title, string Author, bool Published, DateTime Date);

    private readonly List<PageItem> _pages = new()
    {
        new("About Us", "/about-us", true, DateTime.Now.AddDays(-5)),
        new("Our History", "/our-history", true, DateTime.Now.AddDays(-10)),
        new("Cabinet", "/cabinet", true, DateTime.Now.AddDays(-15)),
        new("Recognitions", "/recognitions", false, DateTime.Now.AddDays(-2))
    };

    private readonly List<NewsItem> _news = new()
    {
        new("New Citizenship Portal Launched", "Admin", true, DateTime.Now.AddDays(-1)),
        new("Annual Budget Announcement", "Secretary", true, DateTime.Now.AddDays(-7)),
        new("Upcoming National Holiday", "Editor", false, DateTime.Now.AddDays(-3))
    };
}
