@inherits LayoutComponentBase

<MudThemeProvider Theme="@(GlobalSettings?.GetUserTheme())"  IsDarkMode="@(GlobalSettings is { IsDarkMode: true })" />


<MudBreakpointProvider>
    @Body
</MudBreakpointProvider>

@* <MudLayout> *@
@*     <MudAppBar Elevation="1"> *@
@*         <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@DrawerToggle" /> *@
@*         <MudSpacer /> *@
@*         <MudIconButton Icon="@DarkLightModeButtonIcon" Color="Color.Inherit" OnClick="@DarkModeToggle" /> *@
@*         $1$ <NotificationMenu /> #1# *@
@*         <MudToggleIconButton @bind-Toggled="_notificationDrawerOpen" *@
@*                              Icon="@Icons.Material.Filled.Notifications" *@
@*                              Color="Color.Inherit" *@
@*                              ToggledIcon="@Icons.Material.Filled.Notifications" *@
@*                              ToggledColor="Color.Secondary" *@
@*                              @onclick="@(() => NotificationDrawerToggle())" /> *@
@*          *@
@*         <MudIcon Icon="@Icons.Material.Filled.ShoppingCart"></MudIcon> *@
@*          *@
@*         <MudIconButton Icon="@Icons.Material.Filled.MoreVert" Color="Color.Inherit" Edge="Edge.End" /> *@
@*         <MudFab Color="Color.Primary" Size="Size.Small" IconSize="Size.Small" StartIcon="@Icons.Material.Filled.SupervisedUserCircle" Href="profile" /> *@
@*     </MudAppBar> *@
@*     <MudDrawer @bind-Open="_drawerOpen" Elevation="2"> *@
@*         <MudDrawerHeader> *@
@*             <MudText Typo="Typo.h5" Class="mt-1">@GlobalSettings?.AppName</MudText> *@
@*         </MudDrawerHeader> *@
@*         <NavMenu /> *@
@*     </MudDrawer> *@
@*      *@
@*     <MudDrawer @bind-Open="_notificationDrawerOpen" Elevation="2" Overlay="false" Variant="@DrawerVariant.Responsive"  *@
@*                Anchor="Anchor.Right" Width="400px"> *@
@*         <MudDrawerHeader> *@
@* *@
@*                  *@
@*             <MudStack > *@
@*                 <MudText Typo="Typo.h6" Class="">Notifications</MudText> *@
@*                 <MudButton>Clear All</MudButton> *@
@* *@
@*             </MudStack> *@
@*         *@
@*         </MudDrawerHeader> *@
@*         <MudDrawerContainer Class="mt-2"> *@
@*             <MudPaper > *@
@*                 <NotificationMenu/> *@
@*                  *@
@*             </MudPaper> *@
@*         </MudDrawerContainer> *@
@*          *@
@*     </MudDrawer> *@
@*     <MudMainContent> *@
@*         @Body *@
@*     </MudMainContent> *@
@* </MudLayout> *@

@code {
    [CascadingParameter]
    public GlobalSettings? GlobalSettings { get; set; }

    private MudTheme? _theme = null;
    private bool _drawerOpen = true;
    private bool _notificationDrawerOpen = false;
    

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            if (GlobalSettings is not null)
            {
                // Initialize the theme
                await GlobalSettings.InitializeAsync();
            }
            
        }
    }

    private void NotificationDrawerToggle()
    {
        _notificationDrawerOpen = !_notificationDrawerOpen;
    }

    private void DrawerToggle()
    {
        _drawerOpen = !_drawerOpen;
    }

    private void DarkModeToggle()
    {
        GlobalSettings.IsDarkMode = !GlobalSettings.IsDarkMode;
    }

    public string DarkLightModeButtonIcon => GlobalSettings.IsDarkMode ? Icons.Material.Rounded.LightMode : Icons.Material.Outlined.DarkMode;
    
    
}