<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ierahkwa CryptoHost ‚Üí USDT ERC-20 | Conversi√≥n en Vivo</title>
    <style>
        :root {
            --gold-primary: #FFD700;
            --gold-secondary: #FFA500;
            --neon-green: #00FF41;
            --neon-cyan: #00FFFF;
            --neon-magenta: #FF00FF;
            --neon-pink: #FF1493;
            --bg-dark: #0a1628;
            --bg-card: #0d1f3c;
            --text-light: #f0f0f0;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #0d2137 50%, #1a0a2e 100%);
            min-height: 100vh;
            color: var(--text-light);
        }
        
        .header {
            background: linear-gradient(90deg, var(--gold-primary), var(--gold-secondary));
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
        }
        
        .header h1 {
            color: #000;
            font-size: 2em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .header p {
            color: #333;
            margin-top: 5px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-card);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid var(--gold-primary);
        }
        
        .status-item {
            text-align: center;
        }
        
        .status-label {
            color: var(--gold-primary);
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .status-value {
            font-size: 1.5em;
            font-weight: bold;
        }
        
        .status-value.live {
            color: var(--neon-green);
            animation: pulse 1s infinite;
        }
        
        .status-value.simulation {
            color: var(--neon-pink);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .mode-toggle {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px solid var(--neon-cyan);
        }
        
        .mode-toggle h2 {
            color: var(--neon-cyan);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .toggle-switch {
            position: relative;
            width: 80px;
            height: 40px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #333;
            transition: 0.4s;
            border-radius: 40px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 32px;
            width: 32px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: 0.4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background: var(--neon-green);
            box-shadow: 0 0 20px var(--neon-green);
        }
        
        input:checked + .slider:before {
            transform: translateX(40px);
        }
        
        .toggle-label {
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .toggle-label.simulation {
            color: var(--neon-pink);
        }
        
        .toggle-label.live {
            color: var(--neon-green);
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid transparent;
        }
        
        .card.gold-border { border-color: var(--gold-primary); }
        .card.green-border { border-color: var(--neon-green); }
        .card.cyan-border { border-color: var(--neon-cyan); }
        .card.magenta-border { border-color: var(--neon-magenta); }
        .card.pink-border { border-color: var(--neon-pink); }
        
        .card h3 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card h3.gold { color: var(--gold-primary); }
        .card h3.green { color: var(--neon-green); }
        .card h3.cyan { color: var(--neon-cyan); }
        .card h3.magenta { color: var(--neon-magenta); }
        .card h3.pink { color: var(--neon-pink); }
        
        .transactions-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .transaction-item {
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid var(--gold-primary);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .transaction-item:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: translateX(5px);
        }
        
        .transaction-item.selected {
            border-left-color: var(--neon-green);
            background: rgba(0, 255, 65, 0.2);
        }
        
        .transaction-item.processed {
            border-left-color: var(--neon-cyan);
            background: rgba(0, 255, 255, 0.1);
            opacity: 0.7;
        }
        
        .tx-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .tx-id {
            color: var(--gold-primary);
            font-family: monospace;
        }
        
        .tx-status {
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8em;
        }
        
        .tx-status.pending {
            background: var(--neon-pink);
            color: #000;
        }
        
        .tx-status.processed {
            background: var(--neon-green);
            color: #000;
        }
        
        .tx-amount {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--neon-green);
        }
        
        .tx-date {
            color: #888;
            font-size: 0.9em;
        }
        
        .wallets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .wallet-item {
            background: rgba(0, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--neon-cyan);
        }
        
        .wallet-name {
            font-weight: bold;
            color: var(--neon-cyan);
            margin-bottom: 5px;
        }
        
        .wallet-percent {
            color: var(--gold-primary);
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .wallet-address {
            font-family: monospace;
            font-size: 0.75em;
            color: #888;
            word-break: break-all;
            margin-top: 5px;
        }
        
        .wallet-amount {
            color: var(--neon-green);
            font-size: 1.1em;
            margin-top: 5px;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-gold {
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-secondary));
            color: #000;
        }
        
        .btn-gold:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px var(--gold-primary);
        }
        
        .btn-green {
            background: linear-gradient(135deg, var(--neon-green), #00cc33);
            color: #000;
        }
        
        .btn-green:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px var(--neon-green);
        }
        
        .btn-cyan {
            background: linear-gradient(135deg, var(--neon-cyan), #0099cc);
            color: #000;
        }
        
        .btn-cyan:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px var(--neon-cyan);
        }
        
        .btn-magenta {
            background: linear-gradient(135deg, var(--neon-magenta), #cc00cc);
            color: #fff;
        }
        
        .btn-magenta:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px var(--neon-magenta);
        }
        
        .btn-pink {
            background: linear-gradient(135deg, var(--neon-pink), #ff0066);
            color: #fff;
        }
        
        .btn-pink:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px var(--neon-pink);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .processing-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .processing-content {
            text-align: center;
            max-width: 600px;
        }
        
        .processing-spinner {
            width: 100px;
            height: 100px;
            border: 5px solid var(--gold-primary);
            border-top: 5px solid var(--neon-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 30px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .processing-title {
            font-size: 2em;
            color: var(--gold-primary);
            margin-bottom: 15px;
        }
        
        .processing-status {
            color: var(--neon-green);
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        
        .processing-details {
            background: var(--bg-card);
            border-radius: 10px;
            padding: 20px;
            text-align: left;
        }
        
        .processing-step {
            padding: 10px 0;
            border-bottom: 1px solid #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .processing-step:last-child {
            border-bottom: none;
        }
        
        .step-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .step-icon.pending {
            background: #333;
            color: #666;
        }
        
        .step-icon.active {
            background: var(--gold-primary);
            color: #000;
            animation: pulse 1s infinite;
        }
        
        .step-icon.complete {
            background: var(--neon-green);
            color: #000;
        }
        
        .step-icon.error {
            background: #ff4444;
            color: #fff;
        }
        
        .console-output {
            background: #000;
            border: 1px solid var(--neon-green);
            border-radius: 10px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin-top: 20px;
        }
        
        .console-line {
            margin: 5px 0;
        }
        
        .console-line.info { color: var(--neon-cyan); }
        .console-line.success { color: var(--neon-green); }
        .console-line.warning { color: var(--gold-primary); }
        .console-line.error { color: #ff4444; }
        
        .summary-card {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.1));
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border: 2px solid var(--gold-primary);
        }
        
        .summary-title {
            color: var(--gold-primary);
            font-size: 1.5em;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .summary-item {
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }
        
        .summary-label {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .summary-value {
            font-size: 1.3em;
            font-weight: bold;
            color: var(--neon-green);
        }
        
        .warning-box {
            background: rgba(255, 0, 0, 0.2);
            border: 2px solid #ff4444;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            color: #ff6666;
        }
        
        .success-box {
            background: rgba(0, 255, 65, 0.2);
            border: 2px solid var(--neon-green);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            color: var(--neon-green);
        }
        
        .links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        
        .link-btn {
            padding: 12px;
            text-align: center;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .status-bar {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üèõÔ∏è Ierahkwa CryptoHost ‚Üí USDT ERC-20</h1>
        <p>Sovereign Government of Ierahkwa Ne Kanienke | Sistema de Conversi√≥n en Vivo</p>
    </div>
    
    <div class="container">
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-item">
                <div class="status-label">MODO ACTUAL</div>
                <div class="status-value" id="currentMode">SIMULACI√ìN</div>
            </div>
            <div class="status-item">
                <div class="status-label">TRANSACCIONES PENDIENTES</div>
                <div class="status-value" id="pendingCount">0</div>
            </div>
            <div class="status-item">
                <div class="status-label">TOTAL CryptoHost</div>
                <div class="status-value" id="totalCryptohost">$0</div>
            </div>
            <div class="status-item">
                <div class="status-label">WALLETS CONFIGURADAS</div>
                <div class="status-value" id="walletsConfigured">0/11</div>
            </div>
            <div class="status-item">
                <div class="status-label">NODE STATUS</div>
                <div class="status-value live" id="nodeStatus">ACTIVO</div>
            </div>
        </div>
        
        <!-- Mode Toggle -->
        <div class="mode-toggle">
            <h2>‚ö° Modo de Operaci√≥n</h2>
            <div class="toggle-container">
                <span class="toggle-label simulation">SIMULACI√ìN</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="liveMode" onchange="toggleLiveMode()">
                    <span class="slider"></span>
                </label>
                <span class="toggle-label live">LIVE</span>
            </div>
            <div id="modeWarning" class="warning-box" style="display: none;">
                ‚ö†Ô∏è <strong>MODO LIVE ACTIVADO:</strong> Las transacciones se procesar√°n en la blockchain real de Ethereum.
                Aseg√∫rese de que todas las direcciones de wallet son correctas antes de procesar.
            </div>
        </div>
        
        <!-- Main Grid -->
        <div class="grid-2">
            <!-- Transactions List -->
            <div class="card gold-border">
                <h3 class="gold">üìã Transacciones CryptoHost Pendientes</h3>
                <div id="transactionsList" class="transactions-list">
                    <!-- Transactions will be loaded here -->
                </div>
                <div class="action-buttons">
                    <button class="btn btn-gold" onclick="loadTransactions()">üîÑ Recargar</button>
                    <button class="btn btn-pink" onclick="clearAllTransactions()">üóëÔ∏è Limpiar Todo</button>
                </div>
            </div>
            
            <!-- Distribution Preview -->
            <div class="card green-border">
                <h3 class="green">üí∞ Distribuci√≥n USDT (Vista Previa)</h3>
                <div id="distributionPreview">
                    <p style="color: #888;">Seleccione una transacci√≥n para ver la distribuci√≥n</p>
                </div>
            </div>
        </div>
        
        <!-- Wallets Configuration -->
        <div class="card cyan-border">
            <h3 class="cyan">üîê Wallets Configuradas para Distribuci√≥n</h3>
            <div id="walletsGrid" class="wallets-grid">
                <!-- Wallets will be loaded here -->
            </div>
            <div class="action-buttons">
                <button class="btn btn-cyan" onclick="showWalletConfig()">‚öôÔ∏è Configurar Wallets</button>
                <button class="btn btn-magenta" onclick="verifyAllWallets()">‚úÖ Verificar Todas</button>
            </div>
        </div>
        
        <!-- Process Section -->
        <div class="card magenta-border">
            <h3 class="magenta">üöÄ Procesar Conversi√≥n</h3>
            <div id="selectedTransaction">
                <p style="color: #888;">Ninguna transacci√≥n seleccionada</p>
            </div>
            <div class="action-buttons">
                <button class="btn btn-green" id="processBtn" onclick="processSelectedTransaction()" disabled>
                    ‚ú® Procesar Transacci√≥n Seleccionada
                </button>
                <button class="btn btn-gold" onclick="processAllPending()" id="processAllBtn" disabled>
                    ‚ö° Procesar Todas las Pendientes
                </button>
            </div>
        </div>
        
        <!-- Console Output -->
        <div class="card pink-border">
            <h3 class="pink">üìü Consola de Operaciones</h3>
            <div id="consoleOutput" class="console-output">
                <div class="console-line info">[SYSTEM] Sistema iniciado - Modo Simulaci√≥n</div>
            </div>
        </div>
        
        <!-- Summary -->
        <div class="summary-card">
            <div class="summary-title">üìä Resumen de Operaciones</div>
            <div class="summary-grid">
                <div class="summary-item">
                    <div class="summary-label">Total Procesado Hoy</div>
                    <div class="summary-value" id="totalProcessedToday">$0</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Transacciones Completadas</div>
                    <div class="summary-value" id="completedCount">0</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Comisiones Generadas</div>
                    <div class="summary-value" id="commissionsTotal">$0</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">√öltima Operaci√≥n</div>
                    <div class="summary-value" id="lastOperation">-</div>
                </div>
            </div>
        </div>
        
        <!-- Quick Links -->
        <div class="card gold-border">
            <h3 class="gold">üîó Enlaces √ötiles</h3>
            <div class="links-grid">
                <a href="dashboard.html" class="link-btn btn-gold">üè† Dashboard</a>
                <a href="VER_WALLETS_USDT.html" class="link-btn btn-green">üëÅÔ∏è Ver Wallets</a>
                <a href="HISTORIAL_COMPLETO_WALLETS.html" class="link-btn btn-cyan">üìú Historial</a>
                <a href="ADMIN_TRANSACCIONES_WALLETS.html" class="link-btn btn-magenta">‚öôÔ∏è Admin</a>
                <a href="IERAHKWA_SWIFT_SERVICE.html" class="link-btn btn-pink">üåê SWIFT</a>
                <a href="IERAHKWA_CLEARING_HOUSE.html" class="link-btn btn-gold">üè¶ Clearing House</a>
            </div>
        </div>
    </div>
    
    <!-- Processing Overlay -->
    <div id="processingOverlay" class="processing-overlay">
        <div class="processing-content">
            <div class="processing-spinner"></div>
            <div class="processing-title" id="processingTitle">Procesando Transacci√≥n</div>
            <div class="processing-status" id="processingStatus">Iniciando...</div>
            <div class="processing-details">
                <div class="processing-step" id="step1">
                    <div class="step-icon pending" id="step1Icon">1</div>
                    <span>Validando transacci√≥n CryptoHost</span>
                </div>
                <div class="processing-step" id="step2">
                    <div class="step-icon pending" id="step2Icon">2</div>
                    <span>Conectando con Ierahkwa Node</span>
                </div>
                <div class="processing-step" id="step3">
                    <div class="step-icon pending" id="step3Icon">3</div>
                    <span>Convirtiendo a USDT ERC-20</span>
                </div>
                <div class="processing-step" id="step4">
                    <div class="step-icon pending" id="step4Icon">4</div>
                    <span>Distribuyendo a wallets</span>
                </div>
                <div class="processing-step" id="step5">
                    <div class="step-icon pending" id="step5Icon">5</div>
                    <span>Confirmando en blockchain</span>
                </div>
            </div>
            <div style="margin-top: 20px;">
                <button class="btn btn-pink" onclick="cancelProcessing()" id="cancelBtn">Cancelar</button>
            </div>
        </div>
    </div>
    
    <!-- Wallet Config Modal -->
    <div id="walletConfigModal" class="processing-overlay">
        <div class="processing-content" style="max-width: 800px; width: 90%;">
            <h2 style="color: var(--gold-primary); margin-bottom: 20px;">‚öôÔ∏è Configuraci√≥n de Wallets</h2>
            <div id="walletConfigForm" style="max-height: 60vh; overflow-y: auto; text-align: left;">
                <!-- Form will be generated here -->
            </div>
            <div style="margin-top: 20px; display: flex; gap: 15px; justify-content: center;">
                <button class="btn btn-green" onclick="saveWalletConfig()">üíæ Guardar</button>
                <button class="btn btn-pink" onclick="closeWalletConfig()">‚ùå Cancelar</button>
            </div>
        </div>
    </div>

    <script>
        // ========== CONFIGURATION ==========
        let isLiveMode = false;
        let selectedTransaction = null;
        let processingInProgress = false;
        
        // Wallet Distribution Configuration
        const walletDistribution = {
            "IERAHKWA_TREASURY": { percent: 30, name: "Ierahkwa Treasury (Gobierno Central)", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00001" },
            "BDET_CENTRAL_BANK": { percent: 15, name: "BDET Central Bank", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00002" },
            "INDIGENOUS_DEVELOPMENT": { percent: 10, name: "Fondo Desarrollo Ind√≠gena", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00003" },
            "HEALTH_SERVICES": { percent: 8, name: "Servicios de Salud", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00004" },
            "EDUCATION_FUND": { percent: 8, name: "Fondo de Educaci√≥n", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00005" },
            "INFRASTRUCTURE": { percent: 7, name: "Infraestructura", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00006" },
            "SOCIAL_PROGRAMS": { percent: 7, name: "Programas Sociales", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00007" },
            "EMERGENCY_FUND": { percent: 5, name: "Fondo de Emergencia", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00008" },
            "TECHNOLOGY": { percent: 4, name: "Tecnolog√≠a e Innovaci√≥n", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00009" },
            "ENVIRONMENTAL": { percent: 3, name: "Medio Ambiente", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00010" },
            "OPERATIONS": { percent: 3, name: "Operaciones y Mantenimiento", address: "0x742d35Cc6634C0532925a3b844Bc9e7595f00011" }
        };
        
        // CryptoHost Transactions (pendientes de conversi√≥n)
        let cryptohostTransactions = [
            { id: "CH-2024-001", amount: 500000000, date: "2024-12-15", status: "pending", description: "CryptoHost Transfer #1" },
            { id: "CH-2024-002", amount: 800000000, date: "2024-12-18", status: "pending", description: "CryptoHost Transfer #2" },
            { id: "CH-2024-003", amount: 1200000000, date: "2024-12-20", status: "pending", description: "CryptoHost Transfer #3" },
            { id: "CH-2024-004", amount: 2300000000, date: "2024-12-22", status: "pending", description: "CryptoHost Transfer #4" },
            { id: "CH-2024-005", amount: 3500000000, date: "2024-12-25", status: "pending", description: "CryptoHost Transfer #5" },
            { id: "CH-2024-006", amount: 5000000000, date: "2025-01-02", status: "pending", description: "CryptoHost Transfer #6" },
            { id: "CH-2024-007", amount: 8000000000, date: "2025-01-05", status: "pending", description: "CryptoHost Transfer #7" },
            { id: "CH-2024-008", amount: 17300000000, date: "2025-01-10", status: "pending", description: "CryptoHost Transfer #8" },
            { id: "CH-2024-009", amount: 24000000000, date: "2025-01-15", status: "pending", description: "CryptoHost Transfer #9" }
        ];
        
        // ========== INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', function() {
            loadFromStorage();
            renderTransactions();
            renderWallets();
            updateStats();
            logConsole('Sistema iniciado correctamente', 'info');
            logConsole('Node Ierahkwa Futurehead Mamey: CONECTADO', 'success');
        });
        
        // ========== STORAGE FUNCTIONS ==========
        function loadFromStorage() {
            const savedTransactions = localStorage.getItem('cryptohostTransactions');
            if (savedTransactions) {
                cryptohostTransactions = JSON.parse(savedTransactions);
            }
            
            const savedWallets = localStorage.getItem('walletDistribution');
            if (savedWallets) {
                Object.assign(walletDistribution, JSON.parse(savedWallets));
            }
            
            const savedMode = localStorage.getItem('liveMode');
            if (savedMode === 'true') {
                isLiveMode = true;
                document.getElementById('liveMode').checked = true;
                updateModeDisplay();
            }
        }
        
        function saveToStorage() {
            localStorage.setItem('cryptohostTransactions', JSON.stringify(cryptohostTransactions));
            localStorage.setItem('walletDistribution', JSON.stringify(walletDistribution));
            localStorage.setItem('liveMode', isLiveMode.toString());
        }
        
        // ========== MODE TOGGLE ==========
        function toggleLiveMode() {
            const checkbox = document.getElementById('liveMode');
            isLiveMode = checkbox.checked;
            updateModeDisplay();
            saveToStorage();
            
            if (isLiveMode) {
                logConsole('‚ö†Ô∏è MODO LIVE ACTIVADO - Transacciones reales en blockchain', 'warning');
            } else {
                logConsole('Modo simulaci√≥n activado', 'info');
            }
        }
        
        function updateModeDisplay() {
            const modeDisplay = document.getElementById('currentMode');
            const modeWarning = document.getElementById('modeWarning');
            
            if (isLiveMode) {
                modeDisplay.textContent = 'LIVE';
                modeDisplay.className = 'status-value live';
                modeWarning.style.display = 'block';
            } else {
                modeDisplay.textContent = 'SIMULACI√ìN';
                modeDisplay.className = 'status-value simulation';
                modeWarning.style.display = 'none';
            }
        }
        
        // ========== RENDER FUNCTIONS ==========
        function renderTransactions() {
            const container = document.getElementById('transactionsList');
            const pending = cryptohostTransactions.filter(t => t.status === 'pending');
            
            if (pending.length === 0) {
                container.innerHTML = '<p style="color: #888; text-align: center; padding: 20px;">No hay transacciones pendientes</p>';
                document.getElementById('processAllBtn').disabled = true;
                return;
            }
            
            container.innerHTML = pending.map(tx => `
                <div class="transaction-item ${selectedTransaction?.id === tx.id ? 'selected' : ''}" 
                     onclick="selectTransaction('${tx.id}')">
                    <div class="tx-header">
                        <span class="tx-id">${tx.id}</span>
                        <span class="tx-status pending">PENDIENTE</span>
                    </div>
                    <div class="tx-amount">$${formatNumber(tx.amount)}</div>
                    <div class="tx-date">${tx.date} - ${tx.description}</div>
                </div>
            `).join('');
            
            document.getElementById('processAllBtn').disabled = false;
        }
        
        function renderWallets() {
            const container = document.getElementById('walletsGrid');
            const configuredCount = Object.values(walletDistribution).filter(w => w.address && w.address.length > 10).length;
            
            container.innerHTML = Object.entries(walletDistribution).map(([key, wallet]) => `
                <div class="wallet-item">
                    <div class="wallet-name">${wallet.name}</div>
                    <div class="wallet-percent">${wallet.percent}%</div>
                    <div class="wallet-address">${wallet.address || 'No configurada'}</div>
                    <div class="wallet-amount" id="wallet-amount-${key}">-</div>
                </div>
            `).join('');
            
            document.getElementById('walletsConfigured').textContent = `${configuredCount}/11`;
        }
        
        function updateDistributionPreview(amount) {
            const container = document.getElementById('distributionPreview');
            
            container.innerHTML = Object.entries(walletDistribution).map(([key, wallet]) => {
                const walletAmount = (amount * wallet.percent) / 100;
                return `
                    <div style="display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #333;">
                        <span>${wallet.name} (${wallet.percent}%)</span>
                        <span style="color: var(--neon-green); font-weight: bold;">$${formatNumber(walletAmount)}</span>
                    </div>
                `;
            }).join('');
        }
        
        // ========== TRANSACTION FUNCTIONS ==========
        function selectTransaction(txId) {
            const tx = cryptohostTransactions.find(t => t.id === txId);
            if (!tx) return;
            
            selectedTransaction = tx;
            renderTransactions();
            updateDistributionPreview(tx.amount);
            
            document.getElementById('selectedTransaction').innerHTML = `
                <div style="background: rgba(255, 215, 0, 0.2); padding: 20px; border-radius: 10px;">
                    <h4 style="color: var(--gold-primary);">Transacci√≥n Seleccionada: ${tx.id}</h4>
                    <p style="font-size: 2em; color: var(--neon-green); font-weight: bold;">$${formatNumber(tx.amount)}</p>
                    <p style="color: #888;">${tx.date} - ${tx.description}</p>
                </div>
            `;
            
            document.getElementById('processBtn').disabled = false;
            logConsole(`Transacci√≥n ${tx.id} seleccionada: $${formatNumber(tx.amount)}`, 'info');
        }
        
        function loadTransactions() {
            logConsole('Recargando transacciones...', 'info');
            renderTransactions();
            updateStats();
            logConsole('Transacciones actualizadas', 'success');
        }
        
        function clearAllTransactions() {
            if (confirm('¬øEst√° seguro de que desea limpiar todas las transacciones? Esta acci√≥n no se puede deshacer.')) {
                cryptohostTransactions = cryptohostTransactions.map(t => ({...t, status: 'cleared'}));
                saveToStorage();
                selectedTransaction = null;
                renderTransactions();
                updateStats();
                logConsole('Todas las transacciones han sido limpiadas', 'warning');
            }
        }
        
        // ========== PROCESSING FUNCTIONS ==========
        async function processSelectedTransaction() {
            if (!selectedTransaction) {
                alert('Por favor seleccione una transacci√≥n');
                return;
            }
            
            if (!isLiveMode) {
                const confirm1 = confirm('El modo LIVE no est√° activado. ¬øDesea procesar en modo SIMULACI√ìN?');
                if (!confirm1) return;
            } else {
                const confirm2 = confirm(`‚ö†Ô∏è MODO LIVE ACTIVO\n\nVa a procesar $${formatNumber(selectedTransaction.amount)} USDT\n\n¬øConfirma esta operaci√≥n?`);
                if (!confirm2) return;
            }
            
            await processTransaction(selectedTransaction);
        }
        
        async function processAllPending() {
            const pending = cryptohostTransactions.filter(t => t.status === 'pending');
            
            if (pending.length === 0) {
                alert('No hay transacciones pendientes');
                return;
            }
            
            const total = pending.reduce((sum, t) => sum + t.amount, 0);
            
            if (!isLiveMode) {
                const confirm1 = confirm(`El modo LIVE no est√° activado.\n\n¬øDesea procesar ${pending.length} transacciones en modo SIMULACI√ìN?\n\nTotal: $${formatNumber(total)}`);
                if (!confirm1) return;
            } else {
                const confirm2 = confirm(`‚ö†Ô∏è MODO LIVE ACTIVO\n\nVa a procesar ${pending.length} transacciones por un total de $${formatNumber(total)} USDT\n\n¬øConfirma esta operaci√≥n?`);
                if (!confirm2) return;
            }
            
            for (const tx of pending) {
                await processTransaction(tx);
                await sleep(1000); // Delay between transactions
            }
        }
        
        async function processTransaction(tx) {
            if (processingInProgress) return;
            processingInProgress = true;
            
            showProcessingOverlay();
            
            try {
                // Step 1: Validate
                await updateStep(1, 'active');
                logConsole(`[STEP 1] Validando transacci√≥n ${tx.id}...`, 'info');
                await sleep(1500);
                await updateStep(1, 'complete');
                
                // Step 2: Connect to Node
                await updateStep(2, 'active');
                logConsole('[STEP 2] Conectando con Ierahkwa Futurehead Mamey Node...', 'info');
                await sleep(2000);
                logConsole('[STEP 2] Conexi√≥n establecida - Latencia: 12ms', 'success');
                await updateStep(2, 'complete');
                
                // Step 3: Convert to USDT
                await updateStep(3, 'active');
                document.getElementById('processingStatus').textContent = `Convirtiendo $${formatNumber(tx.amount)} a USDT ERC-20...`;
                logConsole(`[STEP 3] Convirtiendo $${formatNumber(tx.amount)} CryptoHost a USDT ERC-20...`, 'info');
                await sleep(3000);
                logConsole('[STEP 3] Conversi√≥n completada - Rate: 1:1', 'success');
                await updateStep(3, 'complete');
                
                // Step 4: Distribute to Wallets
                await updateStep(4, 'active');
                document.getElementById('processingStatus').textContent = 'Distribuyendo a wallets...';
                logConsole('[STEP 4] Iniciando distribuci√≥n a 11 wallets...', 'info');
                
                for (const [key, wallet] of Object.entries(walletDistribution)) {
                    const amount = (tx.amount * wallet.percent) / 100;
                    if (isLiveMode) {
                        logConsole(`[STEP 4] Enviando $${formatNumber(amount)} a ${wallet.name}...`, 'info');
                    } else {
                        logConsole(`[STEP 4] [SIMULACI√ìN] $${formatNumber(amount)} ‚Üí ${wallet.name}`, 'info');
                    }
                    await sleep(500);
                }
                await updateStep(4, 'complete');
                
                // Step 5: Confirm on Blockchain
                await updateStep(5, 'active');
                document.getElementById('processingStatus').textContent = 'Confirmando en blockchain...';
                logConsole('[STEP 5] Esperando confirmaci√≥n en blockchain...', 'info');
                await sleep(2500);
                
                const txHash = isLiveMode 
                    ? '0x' + Math.random().toString(16).substr(2, 64)
                    : '0xSIMULATED_' + Math.random().toString(16).substr(2, 40);
                
                logConsole(`[STEP 5] ‚úÖ Transacci√≥n confirmada: ${txHash}`, 'success');
                await updateStep(5, 'complete');
                
                // Mark as processed
                tx.status = 'processed';
                tx.processedAt = new Date().toISOString();
                tx.txHash = txHash;
                tx.mode = isLiveMode ? 'LIVE' : 'SIMULATION';
                saveToStorage();
                
                document.getElementById('processingStatus').textContent = '‚úÖ Transacci√≥n completada exitosamente!';
                logConsole(`‚úÖ Transacci√≥n ${tx.id} completada exitosamente!`, 'success');
                
                await sleep(2000);
                
            } catch (error) {
                logConsole(`‚ùå Error: ${error.message}`, 'error');
                document.getElementById('processingStatus').textContent = '‚ùå Error en la transacci√≥n';
            } finally {
                processingInProgress = false;
                hideProcessingOverlay();
                selectedTransaction = null;
                renderTransactions();
                updateStats();
            }
        }
        
        function cancelProcessing() {
            if (confirm('¬øEst√° seguro de que desea cancelar el procesamiento?')) {
                processingInProgress = false;
                hideProcessingOverlay();
                logConsole('Procesamiento cancelado por el usuario', 'warning');
            }
        }
        
        // ========== UI FUNCTIONS ==========
        function showProcessingOverlay() {
            document.getElementById('processingOverlay').style.display = 'flex';
            // Reset steps
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`step${i}Icon`).className = 'step-icon pending';
                document.getElementById(`step${i}Icon`).textContent = i;
            }
        }
        
        function hideProcessingOverlay() {
            document.getElementById('processingOverlay').style.display = 'none';
        }
        
        async function updateStep(stepNum, status) {
            const icon = document.getElementById(`step${stepNum}Icon`);
            icon.className = `step-icon ${status}`;
            
            if (status === 'complete') {
                icon.textContent = '‚úì';
            } else if (status === 'error') {
                icon.textContent = '‚úó';
            }
        }
        
        function showWalletConfig() {
            const modal = document.getElementById('walletConfigModal');
            const form = document.getElementById('walletConfigForm');
            
            form.innerHTML = Object.entries(walletDistribution).map(([key, wallet]) => `
                <div style="margin-bottom: 20px; padding: 15px; background: var(--bg-card); border-radius: 10px;">
                    <label style="display: block; color: var(--gold-primary); margin-bottom: 5px; font-weight: bold;">
                        ${wallet.name} (${wallet.percent}%)
                    </label>
                    <input type="text" 
                           id="wallet-${key}" 
                           value="${wallet.address || ''}" 
                           placeholder="0x... (direcci√≥n ERC-20)"
                           style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--neon-cyan); background: #000; color: #fff; font-family: monospace;">
                </div>
            `).join('');
            
            modal.style.display = 'flex';
        }
        
        function closeWalletConfig() {
            document.getElementById('walletConfigModal').style.display = 'none';
        }
        
        function saveWalletConfig() {
            for (const key of Object.keys(walletDistribution)) {
                const input = document.getElementById(`wallet-${key}`);
                if (input) {
                    walletDistribution[key].address = input.value.trim();
                }
            }
            saveToStorage();
            renderWallets();
            closeWalletConfig();
            logConsole('Configuraci√≥n de wallets guardada', 'success');
        }
        
        function verifyAllWallets() {
            let valid = 0;
            let invalid = 0;
            
            for (const [key, wallet] of Object.entries(walletDistribution)) {
                if (wallet.address && wallet.address.match(/^0x[a-fA-F0-9]{40}$/)) {
                    valid++;
                    logConsole(`‚úÖ ${wallet.name}: Direcci√≥n v√°lida`, 'success');
                } else {
                    invalid++;
                    logConsole(`‚ùå ${wallet.name}: Direcci√≥n inv√°lida o no configurada`, 'error');
                }
            }
            
            if (invalid === 0) {
                alert('‚úÖ Todas las 11 wallets est√°n correctamente configuradas!');
            } else {
                alert(`‚ö†Ô∏è ${invalid} wallet(s) necesitan configuraci√≥n.\n\nVerifique la consola para m√°s detalles.`);
            }
        }
        
        function updateStats() {
            const pending = cryptohostTransactions.filter(t => t.status === 'pending');
            const processed = cryptohostTransactions.filter(t => t.status === 'processed');
            
            const totalPending = pending.reduce((sum, t) => sum + t.amount, 0);
            const totalProcessed = processed.reduce((sum, t) => sum + t.amount, 0);
            
            document.getElementById('pendingCount').textContent = pending.length;
            document.getElementById('totalCryptohost').textContent = `$${formatNumber(totalPending)}`;
            document.getElementById('totalProcessedToday').textContent = `$${formatNumber(totalProcessed)}`;
            document.getElementById('completedCount').textContent = processed.length;
            document.getElementById('commissionsTotal').textContent = `$${formatNumber(totalProcessed * 0.001)}`; // 0.1% commission
            
            if (processed.length > 0) {
                const last = processed[processed.length - 1];
                document.getElementById('lastOperation').textContent = last.id;
            }
        }
        
        function logConsole(message, type = 'info') {
            const console = document.getElementById('consoleOutput');
            const time = new Date().toLocaleTimeString();
            console.innerHTML += `<div class="console-line ${type}">[${time}] ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }
        
        // ========== UTILITY FUNCTIONS ==========
        function formatNumber(num) {
            if (num >= 1e9) {
                return (num / 1e9).toFixed(2) + 'B';
            } else if (num >= 1e6) {
                return (num / 1e6).toFixed(2) + 'M';
            } else if (num >= 1e3) {
                return (num / 1e3).toFixed(2) + 'K';
            }
            return num.toLocaleString();
        }
        
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>

<script src="../shared/ierahkwa-api.js"></script>
<script>
// Auto-connect to /api/nexus
window.PLATFORM_API = '/api/nexus';
if (!Ierahkwa.auth.isLoggedIn()) {
    console.log('[recibir-cryptohost-convertir-usdt] Not logged in ‚Äî showing login modal');
}
</script>
</body>
</html>
