<!DOCTYPE html>
<html lang="es" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
<meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
<meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(self), payment=()">
<meta name="description" content="Plataforma soberana de Mensajeria para la infraestructura digital de 574 naciones tribales - Ierahkwa Ne Kanienke">
<meta name="theme-color" content="#00e5ff">
<link rel="canonical" href="https://ierahkwa.nation/mensajeria-soberana/">
<link rel="manifest" href="../shared/manifest.json">
<link rel="icon" href="../icons/icon-96.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="../icons/icon-192.svg">
<meta property="og:title" content="Mensajeria Soberana ‚Äî Chat Cifrado Pan-Americano">
<meta property="og:description" content="Plataforma soberana de Mensajeria para la infraestructura digital de 574 naciones tribales - Ierahkwa Ne Kanienke">
<meta property="og:type" content="website">
<meta property="og:url" content="https://ierahkwa.nation/mensajeria-soberana/">
<meta property="og:image" content="https://ierahkwa.nation/icons/icon-512.svg">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mensajeria Soberana ‚Äî Chat Cifrado Pan-Americano">
<meta name="twitter:description" content="Plataforma soberana de Mensajeria para la infraestructura digital de 574 naciones tribales - Ierahkwa Ne Kanienke">
<link rel="stylesheet" href="../shared/ierahkwa.css">
<title>Mensajeria Soberana ‚Äî Chat Cifrado Pan-Americano</title>
<style>:root{--accent:#00e5ff}</style>
</head>
<body role="document">
<a href="#main" class="skip-nav">Saltar al contenido principal</a>
<nav aria-label="Navegacion principal">
<div class="logo"><span aria-hidden="true">&#x1F512;</span> Mensajeria Soberana</div>
<ul>
<li><a href="#features">Funciones</a></li>
<li><a href="#preview">Demo</a></li>
<li><a href="#contact">Contacto</a></li>
</ul>
</nav>
<main id="main">
<section class="hero">
<div style="text-align:center;margin-top:1rem"><span class="encrypted-badge" title="Cifrado Post-Quantum Activo"><span aria-hidden="true">‚öõÔ∏è</span> Quantum-Safe</span></div>
<h1><span>Mensajeria Soberana</span><br>Chat Cifrado Pan-Americano</h1>
<p>Mensajeria cifrada soberana para 72 millones de indigenas en 19 paises. Sin metadatos, sin vigilancia, con cifrado post-cuantico.</p>
<div class="hero-visual" aria-label="Animacion de burbujas de chat cifrado">
<div class="bubble">Imaynallan kashanki <span class="lock-icon" aria-hidden="true">&#x1F512;</span></div>
<div class="bubble">Allillanmi, qanri? <span class="lock-icon" aria-hidden="true">&#x1F512;</span></div>
<div class="bubble">Hola hermano <span class="lock-icon" aria-hidden="true">&#x1F512;</span></div>
<div class="bubble">Cifrado E2E activo <span class="lock-icon" aria-hidden="true">&#x1F512;</span></div>
</div>
</section>
<section class="stats" aria-label="Estadisticas principales">
<div class="stat"><div class="num">72M</div><div class="label">Usuarios</div></div>
<div class="stat"><div class="num">19</div><div class="label">Paises</div></div>
<div class="stat"><div class="num">0</div><div class="label">Metadatos</div></div>
<div class="stat"><div class="num">PQC</div><div class="label">Post-Cuantico</div></div>
</section>
<section class="features" id="features">
<h2>10 <span>Funciones</span> Soberanas</h2>
<div class="grid">
<div class="card"><div class="icon" aria-hidden="true">&#x1F510;</div><h3>Cifrado E2E (Double Ratchet)</h3><p>Protocolo Double Ratchet con claves efimeras. Cada mensaje con clave unica.</p></div>
<div class="card"><div class="icon" aria-hidden="true">&#x1F465;</div><h3>Grupos hasta 10K</h3><p>Chats grupales cifrados para comunidades enteras con roles de moderacion.</p></div>
<div class="card"><div class="icon" aria-hidden="true">&#x1F3A4;</div><h3>Mensajes de Voz</h3><p>Notas de voz cifradas con transcripcion automatica en 37 lenguas indigenas.</p></div>
<div class="card"><div class="icon" aria-hidden="true">&#x1F4CE;</div><h3>Archivos Cifrados</h3><p>Comparte documentos, fotos y videos con cifrado de extremo a extremo.</p></div>
<div class="card"><div class="icon" aria-hidden="true">&#x23F3;</div><h3>Mensajes Efimeros</h3><p>Mensajes que desaparecen automaticamente con temporizador configurable.</p></div>
<div class="card"><div class="icon" aria-hidden="true">&#x1F4F1;</div><h3>Multi-Dispositivo</h3><p>Sincronizacion segura entre telefono, tablet y escritorio simultaneamente.</p></div>
<div class="card"><div class="icon" aria-hidden="true">&#x1F3A8;</div><h3>Stickers Indigenas</h3><p>Paquetes de stickers creados por artistas de las 574 naciones tribales.</p></div>
<div class="card"><div class="icon" aria-hidden="true">&#x1F4E2;</div><h3>Canales Comunitarios</h3><p>Canales de difusion para lideres comunitarios y organizaciones.</p></div>
<div class="card"><div class="icon" aria-hidden="true">&#x1F916;</div><h3>API de Bots</h3><p>Plataforma de bots para automatizar servicios comunitarios y alertas.</p></div>
<div class="card"><div class="icon" aria-hidden="true">&#x1F4E1;</div><h3>P2P Offline (Mesh)</h3><p>Relay mesh para enviar mensajes sin internet via Bluetooth y WiFi Direct.</p></div>
</div>
</section>
<section class="chat-preview" id="preview">
<h2>Chat en <span>Vivo</span></h2>
<div class="chat-window" role="img" aria-label="Demostracion de conversacion cifrada en Quechua y Espanol">
<div class="chat-header"><span class="name"><span aria-hidden="true">&#x1F512;</span> Ayllu Cusco</span><span class="status">Cifrado E2E activo</span></div>
<div class="messages">
<div class="msg recv">Imaynallan kashanki, panay?<div class="e2e"><span aria-hidden="true">&#x1F512;</span> Cifrado E2E</div></div>
<div class="msg sent">Allillanmi! Kunan tuta rimanakusun.<div class="e2e"><span aria-hidden="true">&#x1F512;</span> Cifrado E2E</div></div>
<div class="msg recv">Ya, nos vemos en la asamblea virtual.<div class="e2e"><span aria-hidden="true">&#x1F512;</span> Cifrado E2E</div></div>
<div class="msg sent">Perfecto. La llamada sera por Telefonia Soberana.<div class="e2e"><span aria-hidden="true">&#x1F512;</span> Cifrado E2E</div></div>
</div>
<div class="chat-input"><input type="text" placeholder="Escribe un mensaje cifrado..." aria-label="Campo de mensaje"><button type="button">Enviar</button></div>
</div>
</section>
<section class="sec-panel" aria-label="Interconexiones">
<h4><span aria-hidden="true">üîó</span> Interconexiones Activas</h4>
<div class="sec-check"><span class="dot ok" aria-hidden="true"></span><a href="../identidad-soberana/" class="label">Identidad</a><span class="status ok">Conectado</span></div>
<div class="sec-check"><span class="dot ok" aria-hidden="true"></span><a href="../criptografia-soberana/" class="label">Criptografia</a><span class="status ok">Conectado</span></div>
</section>
<section class="sec-panel" aria-label="Estado del Sistema">
<h4><span aria-hidden="true">‚ö°</span> Estado en Tiempo Real</h4>
<div class="sec-check"><span class="dot ok" aria-hidden="true"></span><span class="label">Cifrado Quantum</span><span class="status ok">Activo</span></div>
<div class="sec-check"><span class="dot ok" aria-hidden="true"></span><span class="label">AI Engine</span><span class="status ok">Online</span></div>
<div class="sec-check"><span class="dot ok" aria-hidden="true"></span><span class="label">Bank-Grade TLS</span><span class="status ok">256-bit</span></div>
<div class="sec-check"><span class="dot ok" aria-hidden="true"></span><span class="label">Casino Fair RNG</span><span class="status ok">Verificado</span></div>
<div class="sec-check"><span class="dot ok" aria-hidden="true"></span><span class="label">Soberania Datos</span><span class="status ok">100%</span></div>
<div class="sec-progress"><div class="bar green" style="width:98%"></div></div>
</section>
</main>
<footer id="contact">
<div class="brand">Ierahkwa</div>
<p>Mensajeria Soberana &mdash; Soberania digital para los pueblos originarios de las Americas.</p>
</footer>

<script src="../shared/ierahkwa-api.js"></script>
<script>
// Auto-connect to /api/messaging
window.PLATFORM_API = '/api/messaging';
if (!Ierahkwa.auth.isLoggedIn()) {
    console.log('[mensajeria-soberana] Not logged in ‚Äî showing login modal');
}
</script>
<script>
/* Offline Module ‚Äî Mensajeria Soberana v1.0.0 */
(function(){
  const DB_NAME='ierahkwa-mensajeria-offline';const DB_VER=1;
  const STORES=['mensajes-cache','mensajes-pendientes','contactos','claves-cifrado'];
  let db=null;

  function openDB(){
    return new Promise((resolve,reject)=>{
      const req=indexedDB.open(DB_NAME,DB_VER);
      req.onupgradeneeded=()=>{
        const d=req.result;
        STORES.forEach(s=>{if(!d.objectStoreNames.contains(s))d.createObjectStore(s,{keyPath:'id'})});
      };
      req.onsuccess=()=>{db=req.result;resolve(db)};
      req.onerror=()=>reject(req.error);
    });
  }

  async function cacheRecentMessages(){
    if(!navigator.onLine)return;
    try{
      const res=await fetch('/api/culture/messages/recent?limit=200');
      if(!res.ok)return;const data=await res.json();
      const tx=db.transaction('mensajes-cache','readwrite');
      data.forEach(m=>tx.objectStore('mensajes-cache').put({...m,id:m.messageId,cached:Date.now()}));
      console.log(`[mensajeria-offline] Cached ${data.length} messages`);
    }catch(e){console.warn('[mensajeria-offline] Message cache failed:',e)}
  }

  async function cacheContacts(){
    if(!navigator.onLine)return;
    try{
      const res=await fetch('/api/culture/messages/contacts');
      if(!res.ok)return;const data=await res.json();
      const tx=db.transaction('contactos','readwrite');
      data.forEach(c=>tx.objectStore('contactos').put({...c,id:c.contactId,cached:Date.now()}));
      console.log(`[mensajeria-offline] Cached ${data.length} contacts`);
    }catch(e){console.warn('[mensajeria-offline] Contact cache failed:',e)}
  }

  async function queueMessage(message){
    const tx=db.transaction('mensajes-pendientes','readwrite');
    tx.objectStore('mensajes-pendientes').put({id:Date.now().toString(),...message,queued:Date.now(),synced:false});
    console.log('[mensajeria-offline] Message queued for delivery');
  }

  async function getOfflineMessages(conversationId){
    const tx=db.transaction('mensajes-cache','readonly');
    const all=await new Promise(r=>{tx.objectStore('mensajes-cache').getAll().onsuccess=e=>r(e.target.result)});
    return conversationId?all.filter(m=>m.conversationId===conversationId):all;
  }

  async function getContacts(){
    const tx=db.transaction('contactos','readonly');
    return new Promise(r=>{tx.objectStore('contactos').getAll().onsuccess=e=>r(e.target.result)});
  }

  async function syncMessages(){
    if(!navigator.onLine)return;
    const tx=db.transaction('mensajes-pendientes','readonly');
    const all=await new Promise(r=>{tx.objectStore('mensajes-pendientes').getAll().onsuccess=e=>r(e.target.result)});
    for(const m of all.filter(x=>!x.synced)){
      try{
        await fetch('/api/culture/messages/send',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(m)});
        const tx2=db.transaction('mensajes-pendientes','readwrite');
        tx2.objectStore('mensajes-pendientes').put({...m,synced:true});
      }catch{break}
    }
  }

  function showOfflineBanner(show){
    let b=document.getElementById('offline-banner');
    if(!b){
      b=document.createElement('div');b.id='offline-banner';
      b.style.cssText='position:fixed;bottom:0;left:0;right:0;background:#7c4dff;color:#fff;text-align:center;padding:8px;font-size:13px;font-weight:700;z-index:9999;transform:translateY(100%);transition:transform .3s';
      b.textContent='Modo Offline ‚Äî Mensajes recientes disponibles. Nuevos mensajes se enviaran al reconectar.';
      document.body.appendChild(b);
    }
    b.style.transform=show?'translateY(0)':'translateY(100%)';
  }

  async function init(){
    await openDB();
    if(navigator.onLine){await cacheRecentMessages();await cacheContacts()}
    window.addEventListener('online',()=>{showOfflineBanner(false);syncMessages()});
    window.addEventListener('offline',()=>showOfflineBanner(true));
    if(!navigator.onLine)showOfflineBanner(true);
    console.log('[mensajeria-offline] Initialized ‚Äî messages, contacts, E2E queue');
  }

  window.IerahkwaMensajeriaOffline={getMessages:getOfflineMessages,getContacts,send:queueMessage,sync:syncMessages};
  init();
})();
</script>
<script src="../shared/ierahkwa-security.js"></script>
<script src="../shared/ierahkwa-quantum.js"></script>
<script src="../shared/ierahkwa-protocols.js"></script>
<script src="../shared/ierahkwa-interconnect.js"></script>
<script>if("serviceWorker"in navigator){navigator.serviceWorker.register("../shared/sw.js").catch(function(){})}</script>
<script src="../shared/ierahkwa-agents.js"></script>
</body>
</html>